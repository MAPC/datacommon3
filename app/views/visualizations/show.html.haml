%script{type: "text/javascript", src: "http://metrobostondatacommon.org/media/swfobject/swfobject.js"}

%div.col-md-8.col-xs-12.vis-main
  %h3= @visualization.title
  %img.visual.feature{id: "#{@visualization.id}", src: @visualization.image.url}
    %p#clickto
      %small Click to activate interactive visualization. (Flash required)

%div.col-md-4.col-xs-12.vis-sidebar
  %div.row
    %div.col-md-12.col-sm-5.col-xs-12.vis-abstract
      %p= @visualization.abstract
    %div.col-md-12.col-sm-5.col-xs-12.vis-owner
      %p
        by
        = link_to @visualization.owner, @visualization.owner
      %p= issue_areas_list  @visualization
      %p= data_sources_list @visualization

  %hr

  %div.row
    %div.col-md-12
      - if current_user?(@visualization.owner)
        = link_to 'Edit', edit_visualization_path(@visualization), class: "btn btn-success"
      - if signed_in?
        = link_to 'Duplicate', duplicate_visualization_path(@visualization), class: "btn btn-primary"


:javascript
  
  $(document).on('ready', function () {
    DC.synchEmbedWeaveOnClick("#vis-#{@visualization.id}", #{@visualization.sessionstate});

    $("#vis-#{@visualization.id}").click(function () {
      $('#clickto').hide();
    });
  });